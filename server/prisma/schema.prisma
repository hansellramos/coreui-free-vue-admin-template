generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model accommodations {
  created_at       DateTime  @default(now()) @db.Timestamptz(6)
  venue            String?   @db.Uuid
  date             DateTime? @db.Date
  duration         Decimal?  @db.Decimal
  time             DateTime? @db.Time(6)
  customer         String?   @db.Uuid
  adults           Int?      @default(0)
  children         Int?      @default(0)
  id               String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  plan_id          String?   @db.Uuid
  calculated_price Decimal?  @db.Decimal
  agreed_price     Decimal?  @db.Decimal
}

model payments {
  id              String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  created_at      DateTime  @default(now()) @db.Timestamptz(6)
  type            String?   @db.VarChar(50)
  accommodation   String?   @db.Uuid
  amount          Decimal?  @db.Decimal
  payment_method  String?   @db.VarChar(100)
  payment_date    DateTime? @db.Date
  reference       String?   @db.VarChar(255)
  notes           String?   @db.Text
  receipt_url     String?   @db.Text
  verified        Boolean   @default(false)
  verified_at     DateTime? @db.Timestamptz(6)
  verified_by     String?   @db.VarChar(255)
  created_by      String?   @db.VarChar(255)
  updated_at      DateTime? @db.Timestamptz(6)
  updated_by      String?   @db.VarChar(255)
}

model contact_organization {
  contact      String   @db.Uuid
  organization String   @db.Uuid
  created_at   DateTime @default(now()) @db.Timestamptz(6)
  type         String   @db.VarChar

  @@id([contact, organization])
}

model contact_venue {
  venue      String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  contact    String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  created_at DateTime @default(now()) @db.Timestamptz(6)
  type       String   @db.VarChar

  @@id([venue, contact])
}

model contacts {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  created_at DateTime @default(now()) @db.Timestamptz(6)
  fullname   String?  @db.VarChar
  whatsapp   Decimal? @db.Decimal
  city       String?  @db.VarChar
  state      String?  @db.VarChar
  country    String?  @db.VarChar
  user       String?  @db.Uuid
}

model countries {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  iso        String   @db.VarChar
  iso3       String?  @db.VarChar
  name       String?  @db.VarChar
  phone_code Decimal? @db.Decimal
  created_at DateTime @default(now()) @db.Timestamptz(6)
}

model organizations {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name       String?  @db.VarChar
  system     Boolean? @default(false)
  created_at DateTime @default(now()) @db.Timestamptz(6)
}

model package_prices {
  name           String    @default("Default")
  price          Decimal   @db.Decimal
  start          DateTime? @db.Timestamp(6)
  end            DateTime? @db.Timestamp(6)
  default        Boolean   @default(false)
  is_discount    Boolean?  @default(false)
  discount_type  String?   @db.VarChar
  discount_value Decimal?  @db.Decimal
  created_at     DateTime  @default(now()) @db.Timestamptz(6)
  id             String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  package        String?   @db.Uuid
}

model states {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name       String?  @db.VarChar
  country    String?  @db.VarChar
  iso        String?  @db.VarChar
  iso3       String?  @db.VarChar
  zip        String?  @db.VarChar
  created_at DateTime @default(now()) @db.Timestamptz(6)
}

model users {
  id             String    @id @db.VarChar(255)
  email          String?
  display_name   String?
  avatar_url     String?
  created_at     DateTime? @default(dbgenerated("timezone('utc'::text, now())")) @db.Timestamptz(6)
  preferences    Json?     @default("{}") @db.Json
  is_locked      Boolean?  @default(false)
  role           String?   @default("user") @db.VarChar(50)
  locked_at      DateTime? @db.Timestamptz(6)
  locked_by      String?   @db.VarChar(255)
  profile_id     String?   @db.Uuid
  is_super_admin Boolean   @default(false)
  profile        profiles? @relation(fields: [profile_id], references: [id])
}

model permissions {
  id          String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  code        String   @unique @db.VarChar(100)
  name        String   @db.VarChar(255)
  description String?  @db.Text
  created_at  DateTime @default(now()) @db.Timestamptz(6)
}

model profiles {
  id          String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  code        String   @unique @db.VarChar(100)
  name        String   @db.VarChar(255)
  description String?  @db.Text
  permissions Json     @default("[]") @db.Json
  is_system   Boolean  @default(false)
  created_at  DateTime @default(now()) @db.Timestamptz(6)
  users       users[]
}

model user_organizations {
  user_id         String   @db.VarChar(255)
  organization_id String   @db.Uuid
  created_at      DateTime @default(now()) @db.Timestamptz(6)

  @@id([user_id, organization_id])
}

model subscriptions {
  id                String               @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name              String               @db.VarChar(255)
  description       String?              @db.Text
  is_active         Boolean              @default(true)
  stripe_customer_id String?             @db.VarChar(255)
  stripe_subscription_id String?         @db.VarChar(255)
  plan_type         String               @default("free") @db.VarChar(50)
  max_users         Int                  @default(5)
  max_organizations Int                  @default(1)
  starts_at         DateTime?            @db.Timestamptz(6)
  expires_at        DateTime?            @db.Timestamptz(6)
  created_at        DateTime             @default(now()) @db.Timestamptz(6)
  updated_at        DateTime             @default(now()) @updatedAt @db.Timestamptz(6)
  subscription_users subscription_users[]
}

model subscription_users {
  id               String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  subscription_id  String        @db.Uuid
  user_id          String        @db.VarChar(255)
  role             String        @default("member") @db.VarChar(50)
  is_owner         Boolean       @default(false)
  added_at         DateTime      @default(now()) @db.Timestamptz(6)
  added_by         String?       @db.VarChar(255)
  trial_expires_at DateTime?     @db.Timestamptz(6)
  subscription     subscriptions @relation(fields: [subscription_id], references: [id], onDelete: Cascade)

  @@unique([subscription_id, user_id])
}

model venue_packages {
  created_at  DateTime @default(now()) @db.Timestamptz(6)
  venue       String?  @db.Uuid
  name        String?
  description String?
  features    Json[]   @db.Json
  id          String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
}

model venues {
  id                    String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name                  String?       @db.VarChar
  created_at            DateTime      @default(now()) @db.Timestamptz(6)
  whatsapp              Decimal?      @db.Decimal
  address               String?       @db.VarChar
  zip_code              String?       @db.VarChar
  latitude              Float?
  longitude             Float?
  city                  String?       @db.VarChar
  country               String?       @db.VarChar
  department            String?       @db.VarChar
  suburb                String?       @db.VarChar
  address_reference     String?
  instagram             String?       @db.VarChar
  organization          String?       @db.Uuid
  is_public             Boolean       @default(false)
  waze_link             String?       @db.Text
  google_maps_link      String?       @db.Text
  venue_info            String?       @db.Text
  wifi_ssid             String?       @db.VarChar(100)
  wifi_password         String?       @db.VarChar(100)
  delivery_info         String?       @db.Text
  default_llm_provider  String?       @db.Uuid
  venue_plans           venue_plans[]
}

model sessions {
  sid    String   @id @db.VarChar(255)
  sess   Json
  expire DateTime @db.Timestamptz(6)

  @@index([expire], name: "IDX_session_expire")
}

model incomes {
  id              String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  payment_id      String?  @unique @db.Uuid
  organization_id String?  @db.Uuid
  venue_id        String?  @db.Uuid
  amount          Decimal? @db.Decimal
  type            String?  @db.VarChar(50)
  date            DateTime? @db.Date
  created_at      DateTime @default(now()) @db.Timestamptz(6)
}

model amenities {
  id          String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name        String   @db.VarChar(255)
  description String?  @db.Text
  icon        String?  @db.VarChar(100)
  category    String?  @db.VarChar(100)
  is_active   Boolean  @default(true)
  created_at  DateTime @default(now()) @db.Timestamptz(6)
}

model venue_plans {
  id                      String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  venue_id                String    @db.Uuid
  name                    String    @db.VarChar(255)
  plan_type               String    @db.VarChar(50)
  description             String?   @db.Text
  adult_price             Decimal   @db.Decimal
  child_price             Decimal   @db.Decimal
  infant_max_age          Int       @default(2)
  child_max_age           Int       @default(12)
  free_children_qty       Int?      @default(0)
  free_children_max_age   Int?
  free_children_condition String?   @db.Text
  child_food_price        Decimal?  @db.Decimal
  min_guests              Int       @default(1)
  max_capacity            Int?
  check_in_time           String?   @db.VarChar(10)
  check_out_time          String?   @db.VarChar(10)
  includes_overnight      Boolean   @default(false)
  includes_rooms          Boolean   @default(false)
  includes_food           Boolean   @default(false)
  food_description        String?   @db.Text
  includes_beverages      Boolean   @default(false)
  terms_conditions        String?   @db.Text
  is_active               Boolean   @default(true)
  created_at              DateTime  @default(now()) @db.Timestamptz(6)
  venue                   venues    @relation(fields: [venue_id], references: [id], onDelete: Cascade)
}

model plan_amenities {
  plan_id    String   @db.Uuid
  amenity_id String   @db.Uuid
  quantity   Int?     @default(1)
  notes      String?  @db.VarChar(255)
  created_at DateTime @default(now()) @db.Timestamptz(6)

  @@id([plan_id, amenity_id])
}

model plan_images {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  plan_id    String   @db.Uuid
  image_url  String   @db.Text
  is_cover   Boolean  @default(false)
  sort_order Int      @default(0)
  created_at DateTime @default(now()) @db.Timestamptz(6)
}

model venue_images {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  venue_id   String   @db.Uuid
  image_url  String   @db.Text
  is_cover   Boolean  @default(false)
  sort_order Int      @default(0)
  created_at DateTime @default(now()) @db.Timestamptz(6)
}

model venue_amenities {
  venue_id   String   @db.Uuid
  amenity_id String   @db.Uuid
  notes      String?  @db.VarChar(255)
  created_at DateTime @default(now()) @db.Timestamptz(6)

  @@id([venue_id, amenity_id])
}

model expense_categories {
  id          String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name        String     @db.VarChar(100)
  description String?    @db.Text
  icon        String?    @db.VarChar(50)
  color       String?    @db.VarChar(20)
  is_system   Boolean    @default(false)
  is_active   Boolean    @default(true)
  created_at  DateTime   @default(now()) @db.Timestamptz(6)
  expenses    expenses[]
}

model expenses {
  id                  String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  organization_id     String?             @db.Uuid
  venue_id            String?             @db.Uuid
  category_id         String?             @db.Uuid
  subcategory         String?             @db.VarChar(100)
  provider_id         String?             @db.Uuid
  amount              Decimal             @db.Decimal
  description         String?             @db.Text
  expense_date        DateTime            @db.Date
  reference           String?             @db.VarChar(255)
  receipt_url         String?             @db.Text
  notes               String?             @db.Text
  created_by          String?             @db.VarChar(255)
  created_at          DateTime            @default(now()) @db.Timestamptz(6)
  updated_at          DateTime?           @db.Timestamptz(6)
  updated_by          String?             @db.VarChar(255)
  category            expense_categories? @relation(fields: [category_id], references: [id])
  provider            providers?          @relation(fields: [provider_id], references: [id])
}

model providers {
  id              String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name            String    @db.VarChar(255)
  organization_id String?   @db.Uuid
  phone           String?   @db.VarChar(50)
  email           String?   @db.VarChar(255)
  address         String?   @db.Text
  notes           String?   @db.Text
  created_at      DateTime  @default(now()) @db.Timestamptz(6)
  updated_at      DateTime? @db.Timestamptz(6)
  expenses        expenses[]
}

model deposits {
  id               String             @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  accommodation_id String             @db.Uuid
  venue_id         String?            @db.Uuid
  organization_id  String?            @db.Uuid
  amount           Decimal            @db.Decimal
  status           String             @default("pending") @db.VarChar(50)
  payment_method   String?            @db.VarChar(100)
  payment_date     DateTime?          @db.Date
  reference        String?            @db.VarChar(255)
  receipt_url      String?            @db.Text
  refund_amount    Decimal?           @db.Decimal
  refund_date      DateTime?          @db.Date
  refund_reference String?            @db.VarChar(255)
  damage_amount    Decimal?           @db.Decimal
  damage_notes     String?            @db.Text
  notes            String?            @db.Text
  verified         Boolean            @default(false)
  verified_at      DateTime?          @db.Timestamptz(6)
  verified_by      String?            @db.VarChar(255)
  created_by       String?            @db.VarChar(255)
  created_at       DateTime           @default(now()) @db.Timestamptz(6)
  updated_at       DateTime?          @db.Timestamptz(6)
  updated_by       String?            @db.VarChar(255)
  evidence         deposit_evidence[]
}

model deposit_evidence {
  id          String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  deposit_id  String   @db.Uuid
  image_url   String   @db.Text
  type        String   @db.VarChar(50)
  description String?  @db.Text
  sort_order  Int      @default(0)
  created_at  DateTime @default(now()) @db.Timestamptz(6)
  deposit     deposits @relation(fields: [deposit_id], references: [id], onDelete: Cascade)
}

model llm_providers {
  id          String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  code        String   @unique @db.VarChar(50)
  name        String   @db.VarChar(100)
  api_key     String?  @db.Text
  base_url    String?  @db.Text
  model       String?  @db.VarChar(100)
  is_active   Boolean  @default(true)
  is_default  Boolean  @default(false)
  config      Json?    @db.Json
  created_at  DateTime @default(now()) @db.Timestamptz(6)
  updated_at  DateTime? @db.Timestamptz(6)
}

model ai_settings {
  id                      String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  setting_key             String   @unique @db.VarChar(50)
  provider_code           String   @db.VarChar(50)
  model                   String   @db.VarChar(100)
  created_at              DateTime @default(now()) @db.Timestamptz(6)
  updated_at              DateTime? @db.Timestamptz(6)
}

model message_templates {
  id          String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  venue_id    String?  @db.Uuid
  code        String   @db.VarChar(50)
  name        String   @db.VarChar(255)
  category    String?  @db.VarChar(50)
  content     String   @db.Text
  variables   Json?    @db.Json
  is_system   Boolean  @default(false)
  is_active   Boolean  @default(true)
  sort_order  Int      @default(0)
  created_at  DateTime @default(now()) @db.Timestamptz(6)
  updated_at  DateTime? @db.Timestamptz(6)

  @@unique([venue_id, code])
}

model chat_conversations {
  id          String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  venue_id    String   @db.Uuid
  external_id String?  @db.VarChar(255)
  source      String   @db.VarChar(50)
  phone       String?  @db.VarChar(50)
  name        String?  @db.VarChar(255)
  metadata    Json?    @db.Json
  created_at  DateTime @default(now()) @db.Timestamptz(6)
  updated_at  DateTime? @db.Timestamptz(6)
  messages    chat_messages[]
}

model chat_messages {
  id              String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  conversation_id String   @db.Uuid
  role            String   @db.VarChar(20)
  content         String   @db.Text
  provider        String?  @db.VarChar(50)
  model           String?  @db.VarChar(100)
  tokens_used     Int?
  cost            Decimal? @db.Decimal
  created_at      DateTime @default(now()) @db.Timestamptz(6)
  conversation    chat_conversations @relation(fields: [conversation_id], references: [id], onDelete: Cascade)
}

model estimates {
  id                String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  venue_id          String    @db.Uuid
  plan_id           String?   @db.Uuid
  customer_name     String?   @db.VarChar(255)
  contact_type      String    @db.VarChar(20)
  contact_value     String    @db.VarChar(100)
  check_in          DateTime? @db.Date
  check_out         DateTime? @db.Date
  adults            Int?      @default(0)
  children          Int?      @default(0)
  calculated_price  Decimal?  @db.Decimal
  notes             String?   @db.Text
  status            String    @default("pending") @db.VarChar(50)
  conversation_id   String?   @db.Uuid
  created_by        String?   @db.VarChar(255)
  created_at        DateTime  @default(now()) @db.Timestamptz(6)
  updated_at        DateTime? @db.Timestamptz(6)
  converted_at      DateTime? @db.Timestamptz(6)
  accommodation_id  String?   @db.Uuid
}
